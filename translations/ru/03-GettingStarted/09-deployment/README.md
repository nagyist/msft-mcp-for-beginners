# Развертывание серверов MCP

Развертывание вашего сервера MCP позволяет другим получать доступ к его инструментам и ресурсам за пределами вашей локальной среды. Существует несколько стратегий развертывания, которые стоит рассмотреть в зависимости от ваших требований к масштабируемости, надежности и удобству управления. Ниже вы найдете рекомендации по развертыванию серверов MCP локально, в контейнерах и в облаке.

## Обзор

В этом уроке рассматривается, как развернуть приложение MCP Server.

## Цели обучения

К концу этого урока вы сможете:

- Оценивать разные подходы к развертыванию.
- Развернуть ваше приложение.

## Локальная разработка и развертывание

Если ваш сервер предназначен для использования на машине пользователя, вы можете выполнить следующие шаги:

1. **Скачайте сервер**. Если вы не писали сервер, сначала скачайте его на вашу машину.
1. **Запустите процесс сервера**: Запустите ваше приложение MCP Server.

Для SSE (не требуется для сервера типа stdio):

1. **Настройте сеть**: Убедитесь, что сервер доступен на ожидаемом порту.
1. **Подключите клиентов**: Используйте локальные URL-адреса подключения, например `http://localhost:3000`.

## Облачное развертывание

Сервера MCP можно развернуть на различных облачных платформах:

- **Безсерверные функции**: Разверните легкие MCP серверы в виде безсерверных функций.
- **Контейнерные сервисы**: Используйте сервисы, такие как Azure Container Apps, AWS ECS или Google Cloud Run.
- **Kubernetes**: Развертывайте и управляйте серверами MCP в кластерах Kubernetes для высокой доступности.

### Пример: Azure Container Apps

Azure Container Apps поддерживает развертывание серверов MCP. Это всё ещё в разработке, и текущая поддержка ограничена SSE серверами.

Вот как вы можете это сделать:

1. Клонируйте репозиторий:

  ```sh
  git clone https://github.com/anthonychu/azure-container-apps-mcp-sample.git
  ```

1. Запустите его локально, чтобы протестировать:

  ```sh
  uv venv
  uv sync

  # linux/macOS
  export API_KEYS=<AN_API_KEY>
  # windows
  set API_KEYS=<AN_API_KEY>

  uv run fastapi dev main.py
  ```

1. Чтобы попробовать локально, создайте файл *mcp.json* в директории *.vscode* и добавьте следующее содержимое:

  ```json
  {
      "inputs": [
          {
              "type": "promptString",
              "id": "weather-api-key",
              "description": "Weather API Key",
              "password": true
          }
      ],
      "servers": {
          "weather-sse": {
              "type": "sse",
              "url": "http://localhost:8000/sse",
              "headers": {
                  "x-api-key": "${input:weather-api-key}"
              }
          }
      }
  }
  ```

  После запуска SSE сервера вы можете нажать на значок воспроизведения в JSON файле, теперь инструменты на сервере должны быть распознаны GitHub Copilot, смотрите значок инструмента.

1. Для развертывания выполните следующую команду:

  ```sh
  az containerapp up -g <RESOURCE_GROUP_NAME> -n weather-mcp --environment mcp -l westus --env-vars API_KEYS=<AN_API_KEY> --source .
  ```

Вот и все, разверните сервер локально или в Azure, следуя этим шагам.

## Дополнительные ресурсы

- [Azure Functions + MCP](https://learn.microsoft.com/en-us/samples/azure-samples/remote-mcp-functions-dotnet/remote-mcp-functions-dotnet/)
- [Статья про Azure Container Apps](https://techcommunity.microsoft.com/blog/appsonazureblog/host-remote-mcp-servers-in-azure-container-apps/4403550)
- [Репозиторий Azure Container Apps MCP](https://github.com/anthonychu/azure-container-apps-mcp-sample)

## Что дальше

- Далее: [Расширенные темы сервера](../10-advanced/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Отказ от ответственности**:  
Этот документ был переведен с использованием службы машинного перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на наши усилия обеспечить точность, просим учитывать, что автоматический перевод может содержать ошибки или неточности. Оригинальный документ на его родном языке следует считать авторитетным источником. Для критически важной информации рекомендуется использовать профессиональный перевод, выполненный человеком. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования данного перевода.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->