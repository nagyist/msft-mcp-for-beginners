# ケーススタディ: Azure AI トラベルエージェント – 参照実装

## 概要

[Azure AI トラベルエージェント](https://github.com/Azure-Samples/azure-ai-travel-agents) は、Model Context Protocol (MCP)、Azure OpenAI、および Azure AI Search を使用して、マルチエージェントの AI 搭載旅行プランニングアプリケーションを構築する方法を示す、Microsoft による包括的な参照ソリューションです。このプロジェクトは、複数の AI エージェントのオーケストレーション、企業データとの統合、および現実のシナリオに対応した安全で拡張可能なプラットフォームの提供に関するベストプラクティスを紹介します。

## 主な機能
- **マルチエージェントのオーケストレーション:** MCP を利用して、航空券、ホテル、旅程エージェントなどの専門エージェントを調整し、複雑な旅行プランニング作業を共同で達成します。
- **企業データ統合:** Azure AI Search およびその他の企業データソースに接続し、最新かつ関連性の高い旅行推薦情報を提供します。
- **安全でスケーラブルなアーキテクチャ:** 認証、認可、スケーラブルなデプロイメントに Azure サービスを活用し、企業のセキュリティベストプラクティスに従います。
- **拡張可能なツール:** 再利用可能な MCP ツールとプロンプトテンプレートを実装し、新しいドメインやビジネス要件への迅速な適応を可能にします。
- **ユーザー体験:** Azure OpenAI と MCP によって強化された会話型インターフェースを通じて、ユーザーとトラベルエージェントの対話を提供します。

## アーキテクチャ
![Architecture](https://raw.githubusercontent.com/Azure-Samples/azure-ai-travel-agents/main/docs/ai-travel-agents-architecture-diagram.png)

### アーキテクチャ図の説明

Azure AI トラベルエージェントソリューションは、モジュール性、スケーラビリティ、および複数の AI エージェントと企業データソースの安全な統合のために設計されています。主なコンポーネントとデータフローは次のとおりです：

- **ユーザーインターフェース:** ユーザーは会話型 UI（例えば、ウェブチャットや Teams ボット）を通じてシステムとやりとりし、質問を送信し、旅行推薦を受信します。
- **MCP サーバー:** 中央のオーケストレーターとして機能し、ユーザー入力の受信、コンテキストの管理、および Model Context Protocol を介した専門エージェント（FlightAgent、HotelAgent、ItineraryAgent など）の調整を行います。
- **AI エージェント:** 各エージェントは特定のドメイン（航空券、ホテル、旅程）を担当し、MCP ツールとして実装されています。エージェントはプロンプトテンプレートとロジックを用いてリクエストを処理し、レスポンスを生成します。
- **Azure OpenAI サービス:** 高度な自然言語理解と生成を提供し、ユーザーの意図を解釈し、会話的な応答を生成します。
- **Azure AI Search と企業データ:** エージェントは Azure AI Search およびその他の企業データソースにクエリを投げ、最新のフライト、ホテル、旅行オプションに関する情報を取得します。
- **認証とセキュリティ:** Microsoft Entra ID と統合し、すべてのリソースに対して最小権限アクセス制御を適用します。
- **デプロイメント:** Azure Container Apps でのデプロイを想定し、スケーラビリティ、監視、運用効率を確保します。

このアーキテクチャにより、複数の AI エージェントのシームレスな協調、企業データとの安全な統合、およびドメイン特化型 AI ソリューション構築のための堅牢で拡張可能なプラットフォームが実現されます。

## アーキテクチャ図詳細のステップ・バイ・ステップ説明
大きな旅行を計画するときに、あらゆる細部を手助けする専門家チームがいることを想像してください。Azure AI トラベルエージェントシステムはこれと似たように、各パーツ（チームメンバーのような）が特定の役割を担っています。仕組みは次の通りです：

### ユーザーインターフェース (UI):
これは旅行エージェントの受付のようなものです。あなた（ユーザー）が「パリへの航空券を探して」といった質問やリクエストをする場所です。ウェブサイトのチャットウィンドウやメッセージングアプリであることもあります。

### MCP サーバー（コーディネーター）:
MCP サーバーは受付のマネージャーのような役割で、あなたのリクエストを聞いて、それぞれの専門家にどの部分を担当してもらうか決めます。会話の流れを管理し、全てがスムーズに進むように調整します。

### AI エージェント（専門家アシスタント）:
各エージェントは特定分野の専門家です。あるエージェントは航空券に詳しく、別のエージェントはホテル、さらに別のエージェントは旅程の計画担当です。あなたのリクエストは MCP サーバーを通じて該当するエージェントに送られます。彼らは知識とツールを駆使して最適な選択肢を探します。

### Azure OpenAI サービス（言語の専門家）:
これは、どんな言い回しでもあなたの質問の意図を正確に理解できる言語の専門家のような存在です。エージェントがあなたのリクエストを理解し、自然な会話風の返答を作成するのを助けます。

### Azure AI Search と企業データ（情報ライブラリ）:
最新の旅行情報、フライトスケジュールやホテルの空室状況などを含む大規模で最新の図書館を想像してください。エージェントはこの図書館から最も正確な答えを探し出します。

### 認証とセキュリティ（警備員）:
警備員が特定区域の入場許可をチェックするように、この部分は許可された人やエージェントだけが重要情報にアクセスできるようにします。あなたのデータを安全かつプライベートに守ります。

### Azure Container Apps 上のデプロイメント（建物）:
これらすべてのアシスタントやツールは、安全でスケーラブルな建物（クラウド）内で連携して動作します。つまり、多数のユーザーに同時対応可能で、必要なときにいつでも利用可能な状態を保っています。

## 全体の流れ:

受付（UI）で質問を始めます。
マネージャー（MCP サーバー）がどの専門家（エージェント）が助けるか判断します。
専門家は言語の専門家（OpenAI）を使ってリクエストを理解し、図書館（AI Search）で最適な答えを探します。
警備員（認証）がすべての安全を確保します。
これらすべてが信頼性が高くスケーラブルな建物（Azure Container Apps）内で行われ、スムーズで安全な体験が実現されます。
このチームワークにより、専門家の旅行エージェントが現代オフィスで協力して働くように、このシステムは迅速かつ安全に旅行プラン作成の手助けをします。

## 技術的実装
- **MCP サーバー:** コアのオーケストレーションロジックをホストし、エージェントツールを公開し、複数ステップの旅行プランニングワークフローのコンテキストを管理します。
- **エージェント:** 各エージェント（例: FlightAgent、HotelAgent）は、独自のプロンプトテンプレートとロジックを持つ MCP ツールとして実装されています。
- **Azure 統合:** 自然言語理解に Azure OpenAI、データ取得に Azure AI Search を使用します。
- **セキュリティ:** Microsoft Entra ID と統合し、すべてのリソースに最小権限アクセス制御を適用します。
- **デプロイメント:** スケーラビリティと運用効率のため Azure Container Apps へのデプロイをサポートします。

## 成果と影響
- MCP を使用して複数の AI エージェントを現実の本番環境シナリオでオーケストレーションする方法を実証します。
- エージェント協調、データ統合、および安全なデプロイメントの再利用可能なパターンを提供し、ソリューション開発を加速します。
- MCP と Azure サービスを使ったドメイン特化型 AI 搭載アプリケーション構築の設計図として機能します。

## 参考資料
- [Azure AI Travel Agents GitHub リポジトリ](https://github.com/Azure-Samples/azure-ai-travel-agents)
- [Azure OpenAI サービス](https://azure.microsoft.com/en-us/products/ai-services/openai-service/)
- [Azure AI Search](https://azure.microsoft.com/en-us/products/ai-services/ai-search/)
- [Model Context Protocol (MCP)](https://modelcontextprotocol.io/)

## 次のステップ

- 戻る: [ケーススタディ概要](./README.md)
- 次へ: [YouTube から ADO アイテムを更新](./UpdateADOItemsFromYT.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**免責事項**:  
本書類はAI翻訳サービス「Co-op Translator」（https://github.com/Azure/co-op-translator）を使用して翻訳されました。正確性の向上に努めておりますが、自動翻訳には誤りや不正確な箇所が含まれる可能性があります。原文となる母国語の文書が正式な情報源となります。重要な内容については、専門の人間による翻訳を推奨いたします。本翻訳の使用により生じたいかなる誤解や解釈の相違についても、一切の責任を負いかねます。
<!-- CO-OP TRANSLATOR DISCLAIMER END -->