# MCP ‡®™‡©ç‡®∞‡©ã‡®ü‡©ã‡®ï‡©ã‡®≤ ‡®´‡©Ä‡®ö‡®∞ ‡®°‡©Ç‡©∞‡®ò‡®æ‡®à ‡®®‡®æ‡®≤ ‡®∏‡®Æ‡®ù‡®£‡®æ

‡®á‡®π ‡®ó‡®æ‡®à‡®° ‡®¨‡©Å‡®®‡®ø‡®Ü‡®¶‡©Ä ‡®ü‡©Ç‡®≤ ‡®Ö‡®§‡©á ‡®∏‡®æ‡®ß‡®® ‡®∏‡©∞‡®≠‡®æ‡®≤ ‡®§‡©ã‡®Ç ‡®Ö‡©±‡®ó‡©á ‡®ú‡®æ‡®£ ‡®µ‡®æ‡®≤‡©á ‡®â‡§®‡•ç‡§®‡®§ MCP ‡®™‡©ç‡®∞‡©ã‡®ü‡©ã‡®ï‡©ã‡®≤ ‡®´‡©Ä‡®ö‡®∞‡®æ‡®Ç ‡®¶‡©Ä ‡®ú‡®æ‡®Ç‡®ö ‡®ï‡®∞‡®¶‡©Ä ‡®π‡©à‡•§ ‡®á‡®π ‡®´‡©Ä‡®ö‡®∞ ‡®∏‡®Æ‡®ù‡®®‡®æ ‡®§‡©Å‡®π‡®æ‡®®‡©Ç‡©∞ ‡®π‡©ã‡®∞ ‡®Æ‡®ú‡®º‡®¨‡©Ç‡®§, ‡®â‡®™‡®≠‡©ã‡®ó‡®§‡®æ-‡®Æ‡®ø‡©±‡®§‡®∞ ‡®Ö‡®§‡©á ‡®â‡®§‡®™‡®æ‡®¶‡®®-‡®§‡®ø‡®Ü‡®∞ MCP ‡®∏‡®∞‡®µ‡®∞ ‡®¨‡®£‡®æ‡®â‡®£ ‡®µ‡®ø‡©±‡®ö ‡®Æ‡®¶‡®¶ ‡®ï‡®∞‡®¶‡®æ ‡®π‡©à‡•§

## ‡®´‡©Ä‡®ö‡®∞ ‡®ï‡®µ‡®∞ ‡®ï‡©Ä‡®§‡©á ‡®ó‡®è

1. **‡®™‡©ç‡®∞‡©ã‡®ó‡®∞‡©à‡©±‡®∏ ‡®∏‡©Ç‡®ö‡®®‡®æ‡®µ‡®æ‡®Ç** - ‡®≤‡©∞‡®¨‡©á ‡®∏‡®Æ‡©á‡®Ç ‡®ö‡©±‡®≤ ‡®∞‡®π‡©Ä‡®Ü‡®Ç ‡®ï‡®æ‡®∞‡®µ‡®æ‡®à‡®Ü‡®Ç ‡®≤‡®à ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä ‡®¶‡©Ä ‡®∏‡©Ç‡®ö‡®®‡®æ ‡®¶‡®ø‡®ì
2. **‡®¨‡©á‡®®‡®§‡©Ä ‡®∞‡©±‡®¶‡®ó‡©Ä** - ‡®ï‡®≤‡®æ‡®á‡©∞‡®ü‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®ö‡©±‡®≤ ‡®∞‡®π‡©Ä‡®Ü‡®Ç ‡®¨‡©á‡®®‡®§‡©Ä‡®Ü‡®Ç ‡®∞‡©±‡®¶ ‡®ï‡®∞‡®® ‡®¶‡©Ä ‡®Ü‡®ó‡®ø‡®Ü ‡®¶‡®ø‡®ì
3. **‡®∏‡®æ‡®ß‡®® ‡®ü‡©à‡®Æ‡®™‡®≤‡©á‡®ü‡®∏** - ‡®™‡©à‡®∞‡®æ‡®Æ‡©Ä‡®ü‡®∞‡®æ‡®Ç ‡®®‡®æ‡®≤ ‡®ó‡®§‡©Ä‡®∏‡®º‡©Ä‡®≤ ‡®∏‡®æ‡®ß‡®® URI
4. **‡®∏‡®∞‡®µ‡®∞ ‡®≤‡®æ‡®à‡®´‡®∏‡®æ‡®à‡®ï‡®≤ ‡®á‡®µ‡©à‡®Ç‡®ü‡®∏** - ‡®¢‡©∞‡®ó ‡®®‡®æ‡®≤ ‡®∏‡®º‡©Å‡®∞‡©Ç‡®Ö‡®æ‡®§ ‡®Ö‡®§‡©á ‡®¨‡©∞‡®¶ ‡®ï‡®∞‡©ã
5. **‡®≤‡©å‡®ó‡®ø‡©∞‡®ó ‡®ï‡©∞‡®ü‡®∞‡©ã‡®≤** - ‡®∏‡®∞‡®µ‡®∞-‡®™‡®æ‡®∏‡©á ‡®≤‡©å‡®ó‡®ø‡©∞‡®ó ‡®∏‡©∞‡®∞‡®ö‡®®‡®æ
6. **‡®ó‡®≤‡®§‡©Ä ‡®∏‡©∞‡®≠‡®æ‡®≤‡®£ ‡®¶‡©á ‡®®‡®Æ‡©Ç‡®®‡©á** - ‡®á‡®ï‡®∏‡®æ‡®∞ ‡®ó‡®≤‡®§‡©Ä ‡®ú‡®µ‡®æ‡®¨

---

## 1. ‡®™‡©ç‡®∞‡©ã‡®ó‡®∞‡©à‡©±‡®∏ ‡®∏‡©Ç‡®ö‡®®‡®æ‡®µ‡®æ‡®Ç

‡®ú‡©á‡®ï‡®∞ ‡®ï‡®æ‡®∞‡®µ‡®æ‡®à‡®Ü‡®Ç ‡®µ‡®ø‡©±‡®ö ‡®∏‡®Æ‡®æ‡®Ç ‡®≤‡©±‡®ó‡®¶‡®æ ‡®π‡©à (‡®°‡®æ‡®ü‡®æ ‡®™‡©ç‡®∞‡©ã‡®∏‡©à‡®∏‡®ø‡©∞‡®ó, ‡®´‡®æ‡®á‡®≤ ‡®°‡®æ‡®ä‡®®‡®≤‡©ã‡®°, API ‡®ï‡®æ‡®≤), ‡®§‡®æ‡®Ç ‡®™‡©ç‡®∞‡©ã‡®ó‡®∞‡©à‡©±‡®∏ ‡®∏‡©Ç‡®ö‡®®‡®æ‡®µ‡®æ‡®Ç ‡®â‡®™‡®≠‡©ã‡®ó‡®§‡®æ‡®µ‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®ú‡®æ‡®£‡©Ç ‡®∞‡©±‡®ñ‡®¶‡©Ä‡®Ü‡®Ç ‡®π‡®®‡•§

### ‡®á‡®π ‡®ï‡®ø‡®µ‡©á‡®Ç ‡®ï‡©∞‡®Æ ‡®ï‡®∞‡®¶‡®æ ‡®π‡©à

```mermaid
sequenceDiagram
    participant Client
    participant Server
    
    Client->>Server: tools/call (‡®≤‡©∞‡®Æ‡®æ ‡®Ü‡®™‡©ç‡®∞‡©á‡®∏‡®º‡®®)
    Server-->>Client: ‡®∏‡©Ç‡®ö‡®®‡®æ: ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä 10%
    Server-->>Client: ‡®∏‡©Ç‡®ö‡®®‡®æ: ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä 50%
    Server-->>Client: ‡®∏‡©Ç‡®ö‡®®‡®æ: ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä 90%
    Server->>Client: ‡®®‡®§‡©Ä‡®ú‡®æ (‡®™‡©Ç‡®∞‡®æ)
```
### Python ‡®á‡©∞‡®™‡®≤‡©Ä‡®Æ‡©à‡®Ç‡®ü‡©á‡®∏‡®º‡®®

```python
from mcp.server import Server, NotificationOptions
from mcp.types import ProgressNotification
import asyncio

app = Server("progress-server")

@app.tool()
async def process_large_file(file_path: str, ctx) -> str:
    """Process a large file with progress updates."""
    
    # ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä ‡®ó‡®£‡®®‡®æ ‡®≤‡®à ‡®´‡®æ‡®á‡®≤ ‡®¶‡®æ ‡®Ü‡®ï‡®æ‡®∞ ‡®™‡©ç‡®∞‡®æ‡®™‡®§ ‡®ï‡®∞‡©ã
    file_size = os.path.getsize(file_path)
    processed = 0
    
    with open(file_path, 'rb') as f:
        while chunk := f.read(8192):
            # ‡®ö‡©∞‡®ï ‡®®‡©Ç‡©∞ ‡®™‡©ç‡®∞‡®ï‡®ø‡®∞‡®ø‡®Ü ‡®ï‡®∞‡©ã
            await process_chunk(chunk)
            processed += len(chunk)
            
            # ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä ‡®∏‡©Ç‡®ö‡®®‡®æ ‡®≠‡©á‡®ú‡©ã
            progress = (processed / file_size) * 100
            await ctx.send_notification(
                ProgressNotification(
                    progressToken=ctx.request_id,
                    progress=progress,
                    total=100,
                    message=f"Processing: {progress:.1f}%"
                )
            )
    
    return f"Processed {file_size} bytes"

@app.tool()
async def batch_operation(items: list[str], ctx) -> str:
    """Process multiple items with progress."""
    
    results = []
    total = len(items)
    
    for i, item in enumerate(items):
        result = await process_item(item)
        results.append(result)
        
        # ‡®π‡®∞ ‡®á‡®ï ‡®Ü‡®à‡®ü‡®Æ ‡®§‡©ã‡®Ç ‡®¨‡®æ‡®Ö‡®¶ ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä ‡®¶‡©Ä ‡®∞‡®ø‡®™‡©ã‡®∞‡®ü ‡®ï‡®∞‡©ã
        await ctx.send_notification(
            ProgressNotification(
                progressToken=ctx.request_id,
                progress=i + 1,
                total=total,
                message=f"Processed {i + 1}/{total}: {item}"
            )
        )
    
    return f"Completed {total} items"
```

### TypeScript ‡®á‡©∞‡®™‡®≤‡©Ä‡®Æ‡©à‡®Ç‡®ü‡©á‡®∏‡®º‡®®

```typescript
import { Server } from "@modelcontextprotocol/sdk/server/index.js";

server.setRequestHandler(CallToolSchema, async (request, extra) => {
  const { name, arguments: args } = request.params;
  
  if (name === "process_data") {
    const items = args.items as string[];
    const results = [];
    
    for (let i = 0; i < items.length; i++) {
      const result = await processItem(items[i]);
      results.push(result);
      
      // ‡®™‡©ç‡®∞‡®ó‡®§‡©Ä ‡®∏‡©Ç‡®ö‡®®‡®æ ‡®≠‡©á‡®ú‡©ã
      await extra.sendNotification({
        method: "notifications/progress",
        params: {
          progressToken: request.id,
          progress: i + 1,
          total: items.length,
          message: `Processing item ${i + 1}/${items.length}`
        }
      });
    }
    
    return { content: [{ type: "text", text: JSON.stringify(results) }] };
  }
});
```

### ‡®ï‡®≤‡®æ‡®á‡©∞‡®ü ‡®∏‡©∞‡®≠‡®æ‡®≤ (Python)

```python
async def handle_progress(notification):
    """Handle progress notifications from server."""
    params = notification.params
    print(f"Progress: {params.progress}/{params.total} - {params.message}")

# ‡®π‡©à‡®Ç‡®°‡®≤‡®∞ ‡®∞‡®ú‡®ø‡®∏‡®ü‡®∞ ‡®ï‡®∞‡©ã
session.on_notification("notifications/progress", handle_progress)

# ‡®ü‡©Ç‡®≤ ‡®ï‡®æ‡®≤ ‡®ï‡®∞‡©ã (‡®™‡©ç‡®∞‡®ó‡®§‡©Ä ‡®Ö‡®™‡®°‡©á‡®ü ‡®π‡®®‡®°‡®≤‡®∞ ‡®∞‡®æ‡®π‡©Ä‡®Ç ‡®Ü‡®à‡®Ç‡®ó‡©á)
result = await session.call_tool("process_large_file", {"file_path": "/data/large.csv"})
```

---

## 2. ‡®¨‡©á‡®®‡®§‡©Ä ‡®∞‡©±‡®¶‡®ó‡©Ä

‡®ï‡®≤‡®æ‡®á‡©∞‡®ü‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®â‡®π‡®®‡®æ‡®Ç ‡®¨‡©á‡®®‡®§‡©Ä‡®Ü‡®Ç ‡®®‡©Ç‡©∞ ‡®∞‡©±‡®¶ ‡®ï‡®∞‡®® ‡®¶‡®ø‡®ì ‡®ú‡©ã ‡®π‡©Å‡®£ ‡®≤‡©ã‡©ú‡©Ä‡®Ç‡®¶‡©Ä‡®Ü‡®Ç ‡®®‡®π‡©Ä‡®Ç ‡®ú‡®æ‡®Ç ‡®ú‡®º‡®ø‡®Ü‡®¶‡®æ ‡®∏‡®Æ‡®æ‡®Ç ‡®≤‡©à ‡®∞‡®π‡©Ä‡®Ü‡®Ç ‡®π‡®®‡•§

### Python ‡®á‡©∞‡®™‡®≤‡©Ä‡®Æ‡©à‡®Ç‡®ü‡©á‡®∏‡®º‡®®

```python
from mcp.server import Server
from mcp.types import CancelledError
import asyncio

app = Server("cancellable-server")

@app.tool()
async def long_running_search(query: str, ctx) -> str:
    """Search that can be cancelled."""
    
    results = []
    
    try:
        for page in range(100):  # ‡®¨‡®π‡©Å‡®§ ‡®∏‡®æ‡®∞‡©Ä‡®Ü‡®Ç ‡®™‡©∞‡®®‡®ø‡®Ü‡®Ç ‡®µ‡®ø‡©±‡®ö ‡®ñ‡©ã‡®ú ‡®ï‡®∞‡©ã
            # ‡®ú‡®æ‡®Ç‡®ö‡©ã ‡®ï‡®ø ‡®∞‡©±‡®¶ ‡®ï‡®∞‡®® ‡®¶‡©Ä ‡®¨‡©á‡®®‡®§‡©Ä ‡®ï‡©Ä‡®§‡©Ä ‡®ó‡®à ‡®∏‡©Ä ‡®ú‡®æ‡®Ç ‡®®‡®π‡©Ä‡®Ç
            if ctx.is_cancelled:
                raise CancelledError("Search cancelled by user")
            
            # ‡®™‡©∞‡®®‡®æ ‡®ñ‡©ã‡®ú ‡®¶‡®æ ‡®®‡®ï‡®≤ ‡®¨‡®£‡®æ ‡®ï‡©á ‡®¶‡®ø‡®ñ‡®æ‡®ì
            page_results = await search_page(query, page)
            results.extend(page_results)
            
            # ‡®õ‡©ã‡®ü‡®æ ‡®¶‡©á‡®∞‡©Ä ‡®∞‡©±‡®¶ ‡®ï‡®∞‡®® ‡®¶‡©Ä ‡®ú‡®æ‡®Ç‡®ö ‡®ï‡®∞‡®® ‡®¶‡©Ä ‡®Ü‡®ó‡®ø‡®Ü ‡®¶‡®ø‡©∞‡®¶‡©Ä ‡®π‡©à
            await asyncio.sleep(0.1)
            
    except CancelledError:
        # ‡®Ö‡®ß‡©Ç‡®∞‡©á ‡®®‡®§‡©Ä‡®ú‡©á ‡®µ‡®æ‡®™‡®∏ ‡®ï‡®∞‡©ã
        return f"Cancelled. Found {len(results)} results before cancellation."
    
    return f"Found {len(results)} total results"

@app.tool()
async def download_file(url: str, ctx) -> str:
    """Download with cancellation support."""
    
    async with aiohttp.ClientSession() as session:
        async with session.get(url) as response:
            total_size = int(response.headers.get('content-length', 0))
            downloaded = 0
            chunks = []
            
            async for chunk in response.content.iter_chunked(8192):
                if ctx.is_cancelled:
                    return f"Download cancelled at {downloaded}/{total_size} bytes"
                
                chunks.append(chunk)
                downloaded += len(chunk)
            
            return f"Downloaded {downloaded} bytes"
```

### ‡®∞‡©±‡®¶‡®ó‡©Ä ‡®∏‡©∞‡®¶‡®∞‡®≠ ‡®≤‡®æ‡®ó‡©Ç ‡®ï‡®∞‡®®‡®æ

```python
class CancellableContext:
    """Context object that tracks cancellation state."""
    
    def __init__(self, request_id: str):
        self.request_id = request_id
        self._cancelled = asyncio.Event()
        self._cancel_reason = None
    
    @property
    def is_cancelled(self) -> bool:
        return self._cancelled.is_set()
    
    def cancel(self, reason: str = "Cancelled"):
        self._cancel_reason = reason
        self._cancelled.set()
    
    async def check_cancelled(self):
        """Raise if cancelled, otherwise continue."""
        if self.is_cancelled:
            raise CancelledError(self._cancel_reason)
    
    async def sleep_or_cancel(self, seconds: float):
        """Sleep that can be interrupted by cancellation."""
        try:
            await asyncio.wait_for(
                self._cancelled.wait(),
                timeout=seconds
            )
            raise CancelledError(self._cancel_reason)
        except asyncio.TimeoutError:
            pass  # ‡®∏‡®ß‡®æ‡®∞‡®£ ‡®∏‡®Æ‡®ø‡®Ü‡®Ç‡®§‡®Æ‡®ø‡®ï‡®§‡®æ, ‡®ú‡®æ‡®∞‡©Ä ‡®∞‡©±‡®ñ‡©ã
```

### ‡®ï‡®≤‡®æ‡®á‡©∞‡®ü-‡®™‡®æ‡®∏‡©á ‡®∞‡©±‡®¶‡®ó‡©Ä

```python
import asyncio

async def search_with_timeout(session, query, timeout=30):
    """Search with automatic cancellation on timeout."""
    
    task = asyncio.create_task(
        session.call_tool("long_running_search", {"query": query})
    )
    
    try:
        result = await asyncio.wait_for(task, timeout=timeout)
        return result
    except asyncio.TimeoutError:
        # ‡®¨‡©á‡®®‡®§‡©Ä ‡®∞‡©±‡®¶ ‡®ï‡®∞‡©ã
        await session.send_notification({
            "method": "notifications/cancelled",
            "params": {"requestId": task.request_id, "reason": "Timeout"}
        })
        return "Search timed out"
```

---

## 3. ‡®∏‡®æ‡®ß‡®® ‡®ü‡©à‡®Æ‡®™‡®≤‡©á‡®ü‡®∏

‡®∏‡®æ‡®ß‡®® ‡®ü‡©à‡®Æ‡®™‡®≤‡©á‡®ü‡®∏ ‡®™‡©à‡®∞‡®æ‡®Æ‡©Ä‡®ü‡®∞‡®æ‡®Ç ‡®®‡®æ‡®≤ ‡®ó‡®§‡©Ä‡®∏‡®º‡©Ä‡®≤ URI ‡®¨‡®£‡®æ‡®â‡®£ ‡®¶‡©Ä ‡®Ü‡®ó‡®ø‡®Ü ‡®¶‡®ø‡©∞‡®¶‡©Ä‡®Ü‡®Ç ‡®π‡®®, ‡®ú‡©ã API ‡®Ö‡®§‡©á ‡®°‡©á‡®ü‡®æ‡®¨‡©á‡®∏ ‡®≤‡®à ‡®≤‡®æ‡®≠‡®¶‡®æ‡®á‡®ï ‡®π‡©à‡•§

### ‡®ü‡©à‡®Æ‡®™‡®≤‡©á‡®ü ‡®™‡®∞‡®ø‡®≠‡®æ‡®∏‡®º‡®ø‡®§ ‡®ï‡®∞‡®®‡®æ

```python
from mcp.server import Server
from mcp.types import ResourceTemplate

app = Server("template-server")

@app.list_resource_templates()
async def list_templates() -> list[ResourceTemplate]:
    """Return available resource templates."""
    return [
        ResourceTemplate(
            uriTemplate="db://users/{user_id}",
            name="User Profile",
            description="Fetch user profile by ID",
            mimeType="application/json"
        ),
        ResourceTemplate(
            uriTemplate="api://weather/{city}/{date}",
            name="Weather Data",
            description="Historical weather for city and date",
            mimeType="application/json"
        ),
        ResourceTemplate(
            uriTemplate="file://{path}",
            name="File Content",
            description="Read file at given path",
            mimeType="text/plain"
        )
    ]

@app.read_resource()
async def read_resource(uri: str) -> str:
    """Read resource, expanding template parameters."""
    
    # ‡®™‡©à‡®∞‡®æ‡®Æ‡©Ä‡®ü‡®∞‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®ï‡©±‡®¢‡®£ ‡®≤‡®à URI ‡®®‡©Ç‡©∞ ‡®µ‡®ø‡®∏‡®º‡®≤‡©á‡®∏‡®º‡®£ ‡®ï‡®∞‡©ã
    if uri.startswith("db://users/"):
        user_id = uri.split("/")[-1]
        return await fetch_user(user_id)
    
    elif uri.startswith("api://weather/"):
        parts = uri.replace("api://weather/", "").split("/")
        city, date = parts[0], parts[1]
        return await fetch_weather(city, date)
    
    elif uri.startswith("file://"):
        path = uri.replace("file://", "")
        return await read_file(path)
    
    raise ValueError(f"Unknown resource URI: {uri}")
```

### TypeScript ‡®á‡©∞‡®™‡®≤‡©Ä‡®Æ‡©à‡®Ç‡®ü‡©á‡®∏‡®º‡®®

```typescript
server.setRequestHandler(ListResourceTemplatesSchema, async () => {
  return {
    resourceTemplates: [
      {
        uriTemplate: "github://repos/{owner}/{repo}/issues/{issue_number}",
        name: "GitHub Issue",
        description: "Fetch a specific GitHub issue",
        mimeType: "application/json"
      },
      {
        uriTemplate: "db://tables/{table}/rows/{id}",
        name: "Database Row",
        description: "Fetch a row from a database table",
        mimeType: "application/json"
      }
    ]
  };
});

server.setRequestHandler(ReadResourceSchema, async (request) => {
  const uri = request.params.uri;
  
  // GitHub ‡®á‡®∏‡®º‡©Ç URI ‡®®‡©Ç‡©∞ ‡®µ‡®ø‡®∏‡®º‡®≤‡©á‡®∏‡®º‡®£ ‡®ï‡®∞‡©ã
  const githubMatch = uri.match(/^github:\/\/repos\/([^/]+)\/([^/]+)\/issues\/(\d+)$/);
  if (githubMatch) {
    const [_, owner, repo, issueNumber] = githubMatch;
    const issue = await fetchGitHubIssue(owner, repo, parseInt(issueNumber));
    return {
      contents: [{
        uri,
        mimeType: "application/json",
        text: JSON.stringify(issue, null, 2)
      }]
    };
  }
  
  throw new Error(`Unknown resource URI: ${uri}`);
});
```

---

## 4. ‡®∏‡®∞‡®µ‡®∞ ‡®≤‡®æ‡®à‡®´‡®∏‡®æ‡®à‡®ï‡®≤ ‡®á‡®µ‡©à‡®Ç‡®ü‡®∏

‡®¢‡©∞‡®ó ‡®®‡®æ‡®≤ ‡®∏‡®º‡©Å‡®∞‡©Ç‡®Ö‡®æ‡®§ ‡®Ö‡®§‡©á ‡®¨‡©∞‡®¶ ‡®ï‡®∞‡®® ‡®®‡®æ‡®≤ ‡®∏‡®æ‡®´‡®º-‡®∏‡©Å‡®•‡®∞‡®æ ‡®∏‡®æ‡®ß‡®® ‡®™‡©ç‡®∞‡®¨‡©∞‡®ß‡®® ‡®®‡®ø‡®∂‡®ö‡®ø‡®§ ‡®π‡©Å‡©∞‡®¶‡®æ ‡®π‡©à‡•§

### Python ‡®≤‡®æ‡®à‡®´‡®∏‡®æ‡®à‡®ï‡®≤ ‡®™‡©ç‡®∞‡®¨‡©∞‡®ß‡®®

```python
from mcp.server import Server
from contextlib import asynccontextmanager

app = Server("lifecycle-server")

# ‡®∏‡®æ‡®Ç‡®ù‡©Ä ‡®∏‡®•‡®ø‡®§‡©Ä
db_connection = None
cache = None

@asynccontextmanager
async def lifespan(server: Server):
    """Manage server lifecycle."""
    global db_connection, cache
    
    # ‡®∏‡®º‡©Å‡®∞‡©Ç‡®Ü‡®§
    print("üöÄ Server starting...")
    db_connection = await create_database_connection()
    cache = await create_cache_client()
    print("‚úÖ Resources initialized")
    
    yield  # ‡®∏‡®∞‡®µ‡®∞ ‡®á‡©±‡®•‡©á ‡®ö‡©±‡®≤‡®¶‡®æ ‡®π‡©à
    
    # ‡®¨‡©∞‡®¶ ‡®ï‡®∞‡®®‡®æ
    print("üõë Server shutting down...")
    await db_connection.close()
    await cache.close()
    print("‚úÖ Resources cleaned up")

app = Server("lifecycle-server", lifespan=lifespan)

@app.tool()
async def query_database(sql: str) -> str:
    """Use the shared database connection."""
    result = await db_connection.execute(sql)
    return str(result)
```

### TypeScript ‡®≤‡®æ‡®à‡®´‡®∏‡®æ‡®à‡®ï‡®≤

```typescript
import { Server } from "@modelcontextprotocol/sdk/server/index.js";

class ManagedServer {
  private server: Server;
  private dbConnection: DatabaseConnection | null = null;
  
  constructor() {
    this.server = new Server({
      name: "lifecycle-server",
      version: "1.0.0"
    });
    
    this.setupHandlers();
  }
  
  async start() {
    // ‡®∏‡®æ‡®ß‡®®‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®∏‡®º‡©Å‡®∞‡©Ç ‡®ï‡®∞‡©ã
    console.log("üöÄ Server starting...");
    this.dbConnection = await createDatabaseConnection();
    console.log("‚úÖ Database connected");
    
    // ‡®∏‡®∞‡®µ‡®∞ ‡®∏‡®º‡©Å‡®∞‡©Ç ‡®ï‡®∞‡©ã
    await this.server.connect(transport);
  }
  
  async stop() {
    // ‡®∏‡®æ‡®ß‡®®‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®∏‡®æ‡®´ ‡®ï‡®∞‡©ã
    console.log("üõë Server shutting down...");
    if (this.dbConnection) {
      await this.dbConnection.close();
    }
    await this.server.close();
    console.log("‚úÖ Cleanup complete");
  }
  
  private setupHandlers() {
    this.server.setRequestHandler(CallToolSchema, async (request) => {
      // ‡®á‡®π.dbConnection ‡®®‡©Ç‡©∞ ‡®∏‡©Å‡®∞‡©±‡®ñ‡®ø‡®Ö‡®§ ‡®§‡©å‡®∞ '‡®§‡©á ‡®µ‡®∞‡®§‡©ã
      // ...
    });
  }
}

// ‡®®‡®∞‡®Æ ‡®¨‡©∞‡®¶ ‡®ï‡®∞‡®® ‡®®‡®æ‡®≤ ‡®µ‡®∞‡®§‡©ã‡®Ç
const server = new ManagedServer();

process.on('SIGINT', async () => {
  await server.stop();
  process.exit(0);
});

await server.start();
```

---

## 5. ‡®≤‡©å‡®ó‡®ø‡©∞‡®ó ‡®ï‡©∞‡®ü‡®∞‡©ã‡®≤

MCP ‡®∏‡®∞‡®µ‡®∞-‡®™‡®æ‡®∏‡©á ‡®≤‡©å‡®ó‡®ø‡©∞‡®ó ‡®≤‡©à‡®µ‡®≤ ‡®®‡®æ‡®≤ ‡®∏‡®π‡®ø‡®Ø‡©ã‡®ó ‡®¶‡®ø‡©∞‡®¶‡®æ ‡®π‡©à ‡®ú‡®ø‡®π‡©ú‡©á ‡®ï‡®≤‡®æ‡®á‡©∞‡®ü‡®æ‡®Ç ‡®¶‡©Å‡®Ü‡®∞‡®æ ‡®®‡®ø‡®Ø‡©∞‡®§‡®∞‡®ø‡®§ ‡®ï‡©Ä‡®§‡©á ‡®ú‡®æ ‡®∏‡®ï‡®¶‡©á ‡®π‡®®‡•§

### ‡®≤‡©å‡®ó‡®ø‡©∞‡®ó ‡®≤‡©à‡®µ‡®≤ ‡®≤‡®æ‡®ó‡©Ç ‡®ï‡®∞‡®®‡®æ

```python
from mcp.server import Server
from mcp.types import LoggingLevel
import logging

app = Server("logging-server")

# MCP ‡®≤‡©à‡®µ‡®≤‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®™‡®æ‡®á‡®•‡®® ‡®≤‡©å‡®ó‡®ø‡©∞‡®ó ‡®≤‡©à‡®µ‡®≤‡®æ‡®Ç ‡®®‡®æ‡®≤ ‡®Æ‡©á‡®™ ‡®ï‡®∞‡©ã
LEVEL_MAP = {
    LoggingLevel.DEBUG: logging.DEBUG,
    LoggingLevel.INFO: logging.INFO,
    LoggingLevel.WARNING: logging.WARNING,
    LoggingLevel.ERROR: logging.ERROR,
}

logger = logging.getLogger("mcp-server")

@app.set_logging_level()
async def set_logging_level(level: LoggingLevel) -> None:
    """Handle client request to change logging level."""
    python_level = LEVEL_MAP.get(level, logging.INFO)
    logger.setLevel(python_level)
    logger.info(f"Logging level set to {level}")

@app.tool()
async def debug_operation(data: str) -> str:
    """Tool with various logging levels."""
    logger.debug(f"Processing data: {data}")
    
    try:
        result = process(data)
        logger.info(f"Successfully processed: {result}")
        return result
    except Exception as e:
        logger.error(f"Processing failed: {e}")
        raise
```

### ‡®ï‡®≤‡®æ‡®á‡©∞‡®ü ‡®®‡©Ç‡©∞ ‡®≤‡©å‡®ó ‡®∏‡©Å‡®®‡©á‡®π‡©á ‡®≠‡©á‡®ú‡®£‡®æ

```python
@app.tool()
async def complex_operation(input: str, ctx) -> str:
    """Operation that logs to client."""
    
    # ‡®≤‡©ã‡®ó ‡®∏‡©Ç‡®ö‡®®‡®æ ‡®ó‡©ç‡®∞‡®æ‡®π‡®ï ‡®®‡©Ç‡©∞ ‡®≠‡©á‡®ú‡©ã
    await ctx.send_log(
        level="info",
        message=f"Starting complex operation with input: {input}"
    )
    
    # ‡®ï‡©∞‡®Æ ‡®ï‡®∞‡©ã...
    result = await do_work(input)
    
    await ctx.send_log(
        level="debug",
        message=f"Operation complete, result size: {len(result)}"
    )
    
    return result
```

---

## 6. ‡®ó‡®≤‡®§‡©Ä ‡®∏‡©∞‡®≠‡®æ‡®≤‡®£ ‡®¶‡©á ‡®®‡®Æ‡©Ç‡®®‡©á

‡®á‡®ï‡®∏‡®æ‡®∞ ‡®ó‡®≤‡®§‡©Ä ‡®∏‡©∞‡®≠‡®æ‡®≤‡®£ ‡®°‡©Ä‡®¨‡©±‡®ó‡®ø‡©∞‡®ó ‡®Ö‡®§‡©á ‡®â‡®™‡®≠‡©ã‡®ó‡®§‡®æ ‡®Ö‡®®‡©Å‡®≠‡®µ ‡®∏‡©Å‡®ß‡®æ‡®∞‡®¶‡®æ ‡®π‡©à‡•§

### MCP ‡®ó‡®≤‡®§‡©Ä ‡®ï‡©ã‡®°

```python
from mcp.types import McpError, ErrorCode

class ToolError(McpError):
    """Base class for tool errors."""
    pass

class ValidationError(ToolError):
    """Invalid input parameters."""
    def __init__(self, message: str):
        super().__init__(ErrorCode.INVALID_PARAMS, message)

class NotFoundError(ToolError):
    """Requested resource not found."""
    def __init__(self, resource: str):
        super().__init__(ErrorCode.INVALID_REQUEST, f"Not found: {resource}")

class PermissionError(ToolError):
    """Access denied."""
    def __init__(self, action: str):
        super().__init__(ErrorCode.INVALID_REQUEST, f"Permission denied: {action}")

class InternalError(ToolError):
    """Internal server error."""
    def __init__(self, message: str):
        super().__init__(ErrorCode.INTERNAL_ERROR, message)
```

### ‡®∏‡©∞‡®∞‡®ö‡®ø‡®§ ‡®ó‡®≤‡®§‡©Ä ‡®ú‡®µ‡®æ‡®¨

```python
@app.tool()
async def safe_operation(input: str) -> str:
    """Tool with comprehensive error handling."""
    
    # ‡®á‡®®‡®™‡©Å‡®ü ‡®®‡©Ç‡©∞ ‡®µ‡©à‡®ß ‡®ï‡®∞‡©ã
    if not input:
        raise ValidationError("Input cannot be empty")
    
    if len(input) > 10000:
        raise ValidationError(f"Input too large: {len(input)} chars (max 10000)")
    
    try:
        # ‡®Ö‡®ß‡®ø‡®ï‡®æ‡®∞‡®æ‡®Ç ‡®¶‡©Ä ‡®ú‡®æ‡®Ç‡®ö ‡®ï‡®∞‡©ã
        if not await check_permission(input):
            raise PermissionError(f"read {input}")
        
        # ‡®ï‡®æ‡®∞‡®µ‡®æ‡®à ‡®ï‡®∞‡©ã
        result = await perform_operation(input)
        
        if result is None:
            raise NotFoundError(input)
        
        return result
        
    except ConnectionError as e:
        raise InternalError(f"Database connection failed: {e}")
    except TimeoutError as e:
        raise InternalError(f"Operation timed out: {e}")
    except Exception as e:
        # ‡®Ö‡®£‡®™‡©á‡®ñ‡©á ‡®§‡®∞‡©Å‡®ü‡©Ä‡®Ü‡®Ç ‡®®‡©Ç‡©∞ ‡®≤‡©å‡®ó ‡®ï‡®∞‡©ã
        logger.exception(f"Unexpected error in safe_operation")
        raise InternalError(f"Unexpected error: {type(e).__name__}")
```

### TypeScript ‡®µ‡®ø‡©±‡®ö ‡®ó‡®≤‡®§‡©Ä ‡®∏‡©∞‡®≠‡®æ‡®≤‡®£

```typescript
import { McpError, ErrorCode } from "@modelcontextprotocol/sdk/types.js";

function validateInput(data: unknown): asserts data is ValidInput {
  if (typeof data !== "object" || data === null) {
    throw new McpError(
      ErrorCode.InvalidParams,
      "Input must be an object"
    );
  }
  // ‡®π‡©ã‡®∞ ‡®™‡©ç‡®∞‡®Æ‡®æ‡®£‡®ø‡®ï‡®§‡®æ...
}

server.setRequestHandler(CallToolSchema, async (request) => {
  try {
    validateInput(request.params.arguments);
    
    const result = await performOperation(request.params.arguments);
    
    return {
      content: [{ type: "text", text: JSON.stringify(result) }]
    };
    
  } catch (error) {
    if (error instanceof McpError) {
      throw error;  // ‡®™‡®π‡®ø‡®≤‡®æ‡®Ç ‡®π‡©Ä ‡®á‡©±‡®ï ‡®ê‡®Æ‡®∏‡©Ä‡®™‡©Ä ‡®ó‡®≤‡®§‡©Ä
    }
    
    // ‡®π‡©ã‡®∞ ‡®ó‡®≤‡®§‡©Ä‡®Ü‡®Ç ‡®¨‡®¶‡®≤‡©ã
    if (error instanceof NotFoundError) {
      throw new McpError(ErrorCode.InvalidRequest, error.message);
    }
    
    // ‡®Ö‡®£‡®ú‡®æ‡®£ ‡®ó‡®≤‡®§‡©Ä
    console.error("Unexpected error:", error);
    throw new McpError(
      ErrorCode.InternalError,
      "An unexpected error occurred"
    );
  }
});
```

---

## ‡®™‡©ç‡®∞‡®Ø‡©ã‡®ó‡®§‡®Æ‡®ï ‡®´‡©Ä‡®ö‡®∞ (MCP 2025-11-25)

‡®á‡®π ‡®´‡©Ä‡®ö‡®∞ ‡®µ‡®ø‡®∏‡®º‡©á‡®∏‡®º‡®§‡®æ‡®µ‡®æ‡®Ç ‡®µ‡®ø‡©±‡®ö ‡®™‡©ç‡®∞‡®Ø‡©ã‡®ó‡®§‡®Æ‡®ï ‡®µ‡®ú‡©ã‡®Ç ‡®®‡®ø‡®∂‡®æ‡®®‡®¶‡©á‡®π ‡®π‡®®:

### ‡®ï‡®æ‡®∞‡®ú (‡®≤‡©∞‡®¨‡©á ‡®∏‡®Æ‡©á‡®Ç ‡®ö‡©±‡®≤ ‡®∞‡®π‡©Ä‡®Ü‡®Ç ‡®ï‡®æ‡®∞‡®µ‡®æ‡®à‡®Ü‡®Ç)

```python
# ‡®ü‡®æ‡®∏‡®ï ‡®∞‡®æ‡®ú ‡®®‡®æ‡®≤ ‡®≤‡©∞‡®Æ‡©á ‡®∏‡®Æ‡©á‡®Ç ‡®ö‡©±‡®≤ ‡®∞‡®π‡©Ä‡®Ü‡®Ç ‡®ï‡®æ‡®∞‡®µ‡®æ‡®à‡®Ü‡®Ç ‡®¶‡®æ ‡®ü‡©ç‡®∞‡©à‡®ï‡®ø‡©∞‡®ó ‡®ï‡®∞‡®® ‡®¶‡©Ä ‡®Ü‡®ó‡®ø‡®Ü ‡®¶‡®ø‡©∞‡®¶‡©á ‡®π‡®®
@app.task()
async def training_task(model_id: str, data_path: str, ctx) -> str:
    """Long-running ML training task."""
    
    # ‡®ü‡®æ‡®∏‡®ï ‡®∏‡®º‡©Å‡®∞‡©Ç ‡®π‡©ã‡®á‡®Ü ‡®¶‡©Ä ‡®∞‡®ø‡®™‡©ã‡®∞‡®ü ‡®ï‡®∞‡©ã
    await ctx.report_status("running", "Initializing training...")
    
    # ‡®∏‡®ø‡®ñ‡®≤‡®æ‡®à ‡®≤‡©Ç‡®™
    for epoch in range(100):
        await train_epoch(model_id, data_path, epoch)
        await ctx.report_status(
            "running",
            f"Training epoch {epoch + 1}/100",
            progress=epoch + 1,
            total=100
        )
    
    await ctx.report_status("completed", "Training finished")
    return f"Model {model_id} trained successfully"
```

### ‡®ü‡©Ç‡®≤ ‡®ü‡®ø‡©±‡®™‡®£‡©Ä‡®Ü‡®Ç

```python
# ‡®ü‡©Ç‡®≤ ‡®¶‡©á ‡®µ‡®ø‡®π‡®æ‡®∞ ‡®¨‡®æ‡®∞‡©á ‡®Æ‡©à‡®ü‡®æ‡®°‡©á‡®ü‡®æ ‡®¶‡®ø‡©∞‡®¶‡©á ‡®π‡®®
@app.tool(
    annotations={
        "destructive": False,      # ‡®°‡©á‡®ü‡®æ ‡®®‡©Ç‡©∞ ‡®¨‡®¶‡®≤‡®¶‡®æ ‡®®‡®π‡©Ä‡®Ç
        "idempotent": True,        # ‡®¶‡©Å‡®¨‡®æ‡®∞‡®æ ‡®ï‡©ã‡®∏‡®º‡®ø‡®∏‡®º ‡®ï‡®∞‡®® ‡®≤‡®à ‡®∏‡©Å‡®∞‡©±‡®ñ‡®ø‡®Ö‡®§
        "timeout_seconds": 30,     # ‡®â‡®Æ‡©Ä‡®¶ ‡®ï‡©Ä‡®§‡©Ä ‡®ú‡®æ ‡®∞‡®π‡©Ä ‡®µ‡©±‡®ß ‡®§‡©ã‡®Ç ‡®µ‡©±‡®ß ‡®Æ‡®ø‡®Ü‡®¶
        "requires_approval": False # ‡®ï‡®ø‡®∏‡©á ‡®â‡®™‡®≠‡©ã‡®ó‡®§‡®æ ‡®¶‡©Ä ‡®Æ‡®®‡®ú‡®º‡©Ç‡®∞‡©Ä ‡®¶‡©Ä ‡®≤‡©ã‡©ú ‡®®‡®π‡©Ä‡®Ç
    }
)
async def safe_query(query: str) -> str:
    """A read-only database query tool."""
    return await execute_read_query(query)
```

---

## ‡®Ö‡®ó‡®≤‡®æ ‡®ï‡©Ä ‡®π‡©à

- [Module 8 - ‡®∏‡®≠ ‡®§‡©ã‡®Ç ‡®µ‡®ß‡©Ä‡®Ü ‡®§‡®∞‡©Ä‡®ï‡©á](../../08-BestPractices/README.md)
- [5.14 - ‡®Æ‡®ï‡®æ‡®Æ ‡®á‡©∞‡®ú‡©Ä‡®®‡©Ä‡®Ö‡®∞‡®ø‡©∞‡®ó](../mcp-contextengineering/README.md)
- [MCP ‡®µ‡®ø‡®∏‡®º‡©á‡®∏‡®º‡®§‡®æ ‡®¨‡®¶‡®≤‡®æ‡®Ö ‡®≤‡®ø‡®∏‡®ü](https://spec.modelcontextprotocol.io/)

---

## ‡®µ‡®æ‡®ß‡©Ç ‡®∏‡®æ‡®ß‡®®

- [MCP ‡®µ‡®ø‡®∏‡®º‡©á‡®∏‡®º‡®§‡®æ 2025-11-25](https://spec.modelcontextprotocol.io/specification/2025-11-25/)
- [JSON-RPC 2.0 ‡®ó‡®≤‡®§‡©Ä ‡®ï‡©ã‡®°](https://www.jsonrpc.org/specification#error_object)
- [Python SDK ‡®â‡®¶‡®æ‡®π‡®∞‡®®‡®æ‡®Ç](https://github.com/modelcontextprotocol/python-sdk/tree/main/examples)
- [TypeScript SDK ‡®â‡®¶‡®æ‡®π‡®∞‡®®‡®æ‡®Ç](https://github.com/modelcontextprotocol/typescript-sdk/tree/main/examples)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**‡®Ö‡®∏‡®µ‡©Ä‡®ï‡®æ‡®∞‡©ã‡®ï‡®§**:  
‡®á‡®π ‡®¶‡®∏‡®§‡®æ‡®µ‡©á‡®ú‡®º AI ‡®Ö‡®®‡©Å‡®µ‡®æ‡®¶ ‡®∏‡©á‡®µ‡®æ [Co-op Translator](https://github.com/Azure/co-op-translator) ‡®¶‡©Ä ‡®µ‡®∞‡®§‡©ã‡®Ç ‡®ï‡®∞‡®ï‡©á ‡®Ö‡®®‡©Å‡®µ‡®æ‡®¶ ‡®ï‡©Ä‡®§‡®æ ‡®ó‡®ø‡®Ü ‡®π‡©à‡•§ ‡®ú‡®¶‡©ã‡®Ç ‡®ï‡®ø ‡®Ö‡®∏‡©Ä‡®Ç ‡®∏‡®π‡©Ä‡®Ö‡®§‡®æ ‡®≤‡®à ‡®Ø‡®§‡®®‡®∏‡®º‡©Ä‡®≤ ‡®π‡®æ‡®Ç, ‡®ï‡®ø‡®∞‡®™‡®æ ‡®ï‡®∞‡®ï‡©á ‡®ß‡®ø‡®Ü‡®® ‡®µ‡®ø‡©±‡®ö ‡®∞‡©±‡®ñ‡©ã ‡®ï‡®ø ‡®Ü‡®ü‡©ã‡®Æ‡©à‡®ü‡®ø‡®ï ‡®Ö‡®®‡©Å‡®µ‡®æ‡®¶ ‡®µ‡®ø‡©±‡®ö ‡®ó‡®≤‡®§‡©Ä‡®Ü‡®Ç ‡®ú‡®æ‡®Ç ‡®Ö‡®∏‡®•‡®ø‡®∞‡®§‡®æ‡®µ‡®æ‡®Ç ‡®π‡©ã ‡®∏‡®ï‡®¶‡©Ä‡®Ü‡®Ç ‡®π‡®®‡•§ ‡®Æ‡©Ç‡®≤ ‡®¶‡®∏‡®§‡®æ‡®µ‡©á‡®ú‡®º ‡®®‡©Ç‡©∞ ‡®á‡®∏ ‡®¶‡©Ä ‡®Æ‡©Ç‡®≤ ‡®≠‡®æ‡®∏‡®º‡®æ ‡®µ‡®ø‡©±‡®ö ‡®π‡©Ä ‡®™‡©ç‡®∞‡®Æ‡®æ‡®£‡®ø‡®ï ‡®∏‡®∞‡©ã‡®§ ‡®Æ‡©∞‡®®‡®£‡®æ ‡®ö‡®æ‡®π‡©Ä‡®¶‡®æ ‡®π‡©à‡•§ ‡®Æ‡®π‡©±‡®§‡®µ‡®™‡©Ç‡®∞‡®® ‡®ú‡®æ‡®£‡®ï‡®æ‡®∞‡©Ä ‡®≤‡®à, ‡®™‡©á‡®∏‡®º‡©á‡®µ‡®∞ ‡®Æ‡®®‡©Å‡©±‡®ñ‡©Ä ‡®Ö‡®®‡©Å‡®µ‡®æ‡®¶ ‡®¶‡©Ä ‡®∏‡®ø‡®´‡®æ‡®∞‡®∏‡®º ‡®ï‡©Ä‡®§‡©Ä ‡®ú‡®æ‡®Ç‡®¶‡©Ä ‡®π‡©à‡•§ ‡®Ö‡®∏‡©Ä‡®Ç ‡®á‡®∏ ‡®Ö‡®®‡©Å‡®µ‡®æ‡®¶ ‡®¶‡©Ä ‡®µ‡®∞‡®§‡©ã‡®Ç ‡®§‡©ã‡®Ç ‡®â‡®§‡®™‡©∞‡®® ‡®ï‡®ø‡®∏‡©á ‡®µ‡©Ä ‡®≠‡©Å‡©±‡®≤-‡®≠‡©Å‡®≤‡®æ‡®à ‡®ú‡®æ‡®Ç ‡®ó‡®≤‡®§ ‡®∏‡®ø‡®∏‡®ø‡®Ü ‡®®‡©Ç‡©∞ ‡®ú‡®º‡®ø‡©∞‡®Æ‡©á‡®µ‡®æ‡®∞ ‡®®‡®π‡©Ä‡®Ç ‡®Æ‡©∞‡®®‡®¶‡©á‡•§
<!-- CO-OP TRANSLATOR DISCLAIMER END -->