# استقرار سرورهای MCP

استقرار سرور MCP شما به دیگران اجازه می‌دهد تا فراتر از محیط محلی‌تان به ابزارها و منابع آن دسترسی داشته باشند. راهکارهای متعددی برای استقرار وجود دارد که بسته به نیازهای شما برای مقیاس‌پذیری، قابلیت اطمینان و سهولت مدیریت باید انتخاب شوند. در ادامه راهنمایی‌هایی برای استقرار سرورهای MCP به صورت محلی، در کانتینرها و در فضای ابری خواهید یافت.

## مرور کلی

این درس به شما یاد می‌دهد چگونه اپلیکیشن سرور MCP خود را استقرار دهید.

## اهداف یادگیری

در پایان این درس، شما قادر خواهید بود:

- رویکردهای مختلف استقرار را ارزیابی کنید.
- اپلیکیشن خود را استقرار دهید.

## توسعه و استقرار محلی

اگر سرور شما قرار است مستقیماً روی ماشین کاربران اجرا شود، می‌توانید مراحل زیر را دنبال کنید:

1. **سرور را دانلود کنید**. اگر سرور را شما ننوشته‌اید، ابتدا آن را روی دستگاه خود دانلود کنید.
1. **فرایند سرور را شروع کنید**: اپلیکیشن سرور MCP خود را اجرا کنید.

برای SSE (نیازی به این مورد برای سرورهای نوع stdio نیست)

1. **پیکربندی شبکه**: اطمینان حاصل کنید که سرور روی پورتی که انتظار می‌رود در دسترس است.
1. **اتصال کلاینت‌ها**: از آدرس‌های اتصال محلی مانند `http://localhost:3000` استفاده کنید.

## استقرار ابری

سرورهای MCP می‌توانند روی پلتفرم‌های ابری مختلفی استقرار یابند:

- **توابع بدون سرور**: سرورهای سبک MCP را به صورت توابع بدون سرور استقرار دهید.
- **خدمات کانتینر**: از خدماتی مانند Azure Container Apps، AWS ECS، یا Google Cloud Run استفاده کنید.
- **کوبرنتیس**: سرورهای MCP را در کلاسترهای کوبرنتیس برای دسترسی بالا استقرار و مدیریت کنید.

### مثال: Azure Container Apps

Azure Container Apps از استقرار سرورهای MCP پشتیبانی می‌کند. این سرویس هنوز در حال توسعه است و در حال حاضر فقط از سرورهای SSE پشتیبانی می‌کند.

در ادامه چگونگی انجام این کار را می‌بینید:

1. یک مخزن را کلون کنید:

  ```sh
  git clone https://github.com/anthonychu/azure-container-apps-mcp-sample.git
  ```

1. آن را به صورت محلی اجرا کنید تا آزمایش کنید:

  ```sh
  uv venv
  uv sync

  # لینوکس/مک‌اواس
  export API_KEYS=<AN_API_KEY>
  # ویندوز
  set API_KEYS=<AN_API_KEY>

  uv run fastapi dev main.py
  ```

1. برای اجرای محلی، یک فایل *mcp.json* در دایرکتوری *.vscode* ایجاد کرده و محتوای زیر را اضافه کنید:

  ```json
  {
      "inputs": [
          {
              "type": "promptString",
              "id": "weather-api-key",
              "description": "Weather API Key",
              "password": true
          }
      ],
      "servers": {
          "weather-sse": {
              "type": "sse",
              "url": "http://localhost:8000/sse",
              "headers": {
                  "x-api-key": "${input:weather-api-key}"
              }
          }
      }
  }
  ```

  هنگامی که سرور SSE راه‌اندازی شد، می‌توانید روی آیکون پخش در فایل JSON کلیک کنید، اکنون باید ابزارها روی سرور توسط GitHub Copilot شناسایی شوند، به آیکون Tool نگاه کنید.

1. برای استقرار، فرمان زیر را اجرا کنید:

  ```sh
  az containerapp up -g <RESOURCE_GROUP_NAME> -n weather-mcp --environment mcp -l westus --env-vars API_KEYS=<AN_API_KEY> --source .
  ```

به این ترتیب، به راحتی می‌توانید به صورت محلی و یا از طریق Azure این سرور را مستقر کنید.

## منابع بیشتر

- [توابع Azure + MCP](https://learn.microsoft.com/en-us/samples/azure-samples/remote-mcp-functions-dotnet/remote-mcp-functions-dotnet/)
- [مقاله Azure Container Apps](https://techcommunity.microsoft.com/blog/appsonazureblog/host-remote-mcp-servers-in-azure-container-apps/4403550)
- [مخزن MCP برای Azure Container Apps](https://github.com/anthonychu/azure-container-apps-mcp-sample)


## گام بعدی

- بعدی: [موضوعات پیشرفته سرور](../10-advanced/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**سلب مسئولیت**:  
این سند با استفاده از سرویس ترجمه ماشینی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما در تلاش برای دقت هستیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است حاوی اشتباهات یا نواقص باشند. سند اصلی به زبان بومی خود باید به‌عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حیاتی، استفاده از ترجمه حرفه‌ای انسانی توصیه می‌شود. ما مسئول هیچ‌گونه سوءتفاهم یا برداشت نادرست ناشی از استفاده از این ترجمه نیستیم.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->