# MCP OAuth2 ഡെമോ

## പരിചയം

OAuth2 എന്നത് അനുമതിക്കുള്ള വ്യവസായ-സ്റ്റാൻഡേർഡ് പ്രോട്ടോകോൾ ആണ്, രഹസ്യ വിവരങ്ങൾ പങ്കുവെക്കാതെ സുരക്ഷിതമായി റിസോഴ്‌സുകളിലേക്ക് പ്രവേശനം സാധ്യമാക്കുന്നു. MCP (മോഡൽ കണ്ടെക്സ്റ്റ് പ്രോട്ടോകോൾ) നടപ്പാക്കലുകളിൽ, OAuth2 ഒരു ശക്തിയുള്ള മാർഗമാണ് ക്ലയന്റുകളെ (ഉദാഹരണത്തിന് AI ഏജന്റുകൾ) തിരിച്ചറിയുകയും MCP സർവർമാരെയും അവരുടെ ഉപകരണങ്ങളെയുമുള്ള ആക്സസ് അനുവദിക്കുകയും ചെയ്യുന്നതിന്.

ഈ പാഠം, എന്റർപ്രൈസ്, പ്രൊഡക്ഷൻ ഡിപ്പ്ലോയ്മെന്റുകൾക്കുള്ള സാധാരണ മാതൃകയായ സ്പ്രിംഗ് ബൂട്ട് ഉപയോഗിച്ച് MCP സർവറുകൾക്കുള്ള OAuth2 ഓത്തന്റിക്കേഷൻ എങ്ങനെ നടപ്പാക്കാമെന്ന് പ്രദർശിപ്പിക്കുന്നു.

## പഠന ലക്ഷ്യങ്ങൾ

ഈ പാഠം പൂർത്തിയാക്കിയപ്പോൾ, നിങ്ങൾക്ക് സാധിക്കും:  
- OAuth2 MCP സർവറുകളിൽ എങ്ങനെ ഇന്റഗ്രേറ്റ് ചെയ്യുന്നുവെന്ന് മനസിലാക്കുക  
- ടോക്കൺ പുറപ്പെടുവിക്കാനായി ഒരു സ്പ്രിംഗ് അതോറിസേഷൻ സർവർ നടപ്പാക്കുക  
- MCP എന്റ്പോയിന്റുകൾ JWT-അധിഷ്ഠിത ഓത്തന്റിക്കേഷൻ ഉപയോഗിച്ച് സംരക്ഷിക്കുക  
- മെഷീൻ-ടു-മെഷീൻ കമ്മ്യൂണിക്കേഷനിനായി ക്ലയന്റ് ക്രെഡൻഷ്യൽസ് ഫ്ലോ കോൺഫിഗർ ചെയ്യുക  

## മുൻകൂട്ടിൽ അറിയേണ്ടത്

- ജावा, സ്പ്രിംഗ് ബൂട്ടിൽ അടിസ്ഥാന അറിവ്  
- മുമ്പത്തെ ഘടകങ്ങളിൽ നിന്ന് MCP ആശയങ്ങൾ പരിചിതം  
- മേവൻ അല്ലെങ്കിൽ ഗ്രേഡിൽ ഇൻസ്റ്റാൾ ചെയ്തിട്ടുള്ളത്  

---

## പ്രൊജക്റ്റ് അവലോകനം

ഈ പ്രൊജക്റ്റ് ഒരു **അറിഞ്ഞ നിലയിലുള്ള സ്പ്രിംഗ് ബൂട്ട് അപേക്ഷ** ആണ്, ഇത് രണ്ട് തരത്തിലുള്ളതായി പ്രവർത്തിക്കുന്നു:

* ഒരു **സ്പ്രിംഗ് അതോറിസേഷൻ സർവർ** (`client_credentials` ഫ്ലോ വഴി JWT ആക്സസ് ടോക്കണുകൾ പുറപ്പെടുവിക്കുന്നത്),  
* കൂടാതെ, ഒരു **റിസോഴ്‌സ് സർവർ** (സ്വതന്ത്രമായി സ്വന്തമായ `/hello` എന്റ്പോയിന്റ് സംരക്ഷിക്കുന്നു).

ഇത് [സ്പ്രിംഗ് ബ്ലോഗ് പോസ്റ്റ് (2 ഏപ്രിൽ 2025)](https://spring.io/blog/2025/04/02/mcp-server-oauth2) ൽ കാണിക്കപ്പെട്ട സംവിധാനത്തെ അനുകരിക്കുന്നു.

---

## ദ്രുത തുടക്കം (ലോക്കൽ)

```bash
# നിർമ്മിക്കുക & പ്രവർത്തിപ്പിക്കുക
./mvnw spring-boot:run

# ഒരു ടോക്കൺ നേടുക
curl -u mcp-client:secret -d grant_type=client_credentials \
     http://localhost:8081/oauth2/token | jq -r .access_token > token.txt

# സംരക്ഷിത എൻഡ്‌പോയിന്റ് വിളിക്കുക
curl -H "Authorization: Bearer $(cat token.txt)" http://localhost:8081/hello
```

---

## OAuth2 കോൺഫിഗറേഷൻ പരീക്ഷണം

താഴെ കൊടുത്തിട്ടുള്ള ഘട്ടങ്ങൾ ഉപയോഗിച്ച് OAuth2 സുരക്ഷാ കോൺഫിഗറേഷൻ നിങ്ങൾക്ക് പരീക്ഷിക്കാം:

### 1. സർവർ പ്രവർത്തിക്കുന്നുണ്ടോ, സുരക്ഷിതമാണോ എന്ന് സ്ഥിരീകരിക്കുക

```bash
# ഇത് 401 അനധികൃതം തിരികെ നൽകണം, OAuth2 സുരക്ഷ സജീവമാണെന്ന് സ്ഥിരീകരിക്കുന്നു
curl -v http://localhost:8081/
```

### 2. ക്ലയന്റ് ക്രെഡൻഷ്യൽസ് ഉപയോഗിച്ച് ആക്സസ് ടോക്കൺ നേടുക

```bash
# പൂർണ ടോക്കൺ പ്രതികരണം നേടുകയും തിരിവഴിക്കുകയും ചെയ്യുക
curl -v -X POST http://localhost:8081/oauth2/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic bWNwLWNsaWVudDpzZWNyZXQ=" \
  -d "grant_type=client_credentials&scope=mcp.access"

# അല്ലെങ്കിൽ ടോക്കൺ മാത്രമേ തിരിവഴിക്കേണ്ടതുള്ളൂ (jq ആവശ്യമാണ്)
curl -s -X POST http://localhost:8081/oauth2/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic bWNwLWNsaWVudDpzZWNyZXQ=" \
  -d "grant_type=client_credentials&scope=mcp.access" | jq -r .access_token > token.txt
```

എന്ന് ശ്രദ്ധിക്കുക: ബേസിക് ഓത്തന്റിക്കേഷൻ ഹെഡർ (`bWNwLWNsaWVudDpzZWNyZXQ=`) `mcp-client:secret`എന്നുള്ള ബേസ്64 എൻകോഡിങ്ങാണ്.

### 3. ആ ടോക്കൺ ഉപയോഗിച്ച് സംരക്ഷിത എന്റ്പോയിന്റിൽ പ്രവേശിക്കുക

```bash
# സേവ് ചെയ്ത ടോക്കൺ ഉപയോഗിച്ച്
curl -H "Authorization: Bearer $(cat token.txt)" http://localhost:8081/hello

# അല്ലെങ്കിൽ ടോക്കൺ മൂല്യത്തോടെ നേരിട്ടു
curl -H "Authorization: Bearer eyJra...token_value...xyz" http://localhost:8081/hello
```

"Hello from MCP OAuth2 Demo!" എന്ന വിജയകരമായ പ്രതികരണം OAuth2 കോൺഫിഗറേഷൻ വിജയകരമായി പ്രവർത്തിക്കുന്നതായി സ്ഥിരീകരിക്കുന്നു.

---

## കോൺടെയ്നർ ബിൽഡ്

```bash
docker build -t mcp-oauth2-demo .
docker run -p 8081:8081 mcp-oauth2-demo
```

---

## **Azure Container Apps**-ലേക്ക് ഡിപ്പ്ലോയ് ചെയ്യുക

```bash
az containerapp up -n mcp-oauth2 \
  -g demo-rg -l westeurope \
  --image <your-registry>/mcp-oauth2-demo:latest \
  --ingress external --target-port 8081
```

ഇൻഗ്രസ് FQDN നിങ്ങളുടെ **ഇഷ്യൂവർ** ആയി മാറും (`https://<fqdn>`).  
`*.azurecontainerapps.io`-യ്ക്ക് വേണ്ടി അവയുടെ വിശ്വസ്ത TLS സർട്ടിഫിക്കറ്റ് ആസ്യൂർ ആവട്ടെ സ്വയം നൽകുന്നു.

---

## **Azure API Management**-ലേക്ക് വൈർ ചെയ്യുക

നിങ്ങളുടെ API-യിൽ താഴെയുള്ള ഇൻബൗണ്ട് പോളിസി ചേർക്കുക:

```xml
<inbound>
  <validate-jwt header-name="Authorization">
    <openid-config url="https://<fqdn>/.well-known/openid-configuration"/>
    <audiences>
      <audience>mcp-client</audience>
    </audiences>
  </validate-jwt>
  <base/>
</inbound>
```

APIM JWKS നടപ്പാക്കുകയും ഓരോ അഭ്യർത്ഥനയും ശാസ്ത്രീയമായി പരിശോധിക്കുകയും ചെയ്യും.

---

## ഇനി എന്ത്

- [5.4 റൂട്ട് കണ്ടെക്സ്റ്റുകൾ](../mcp-root-contexts/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**അസംബന്ധം**:  
ഈ ഡോക്യമെന്റ് AI വിവർത്തന സേവനായ [Co-op Translator](https://github.com/Azure/co-op-translator) ഉപയോഗിച്ചുള്ള വിവർത്തനമാണ്. നമുക്ക് ശുദ്ധിമുട്ടിൽ വന്നു നടത്തുന്നതായിരുന്നാലും, സ്വയം ബുദ്ധിമുട്ടുള്ള വിവർത്തനങ്ങളിൽ തെറ്റുകൾ അല്ലെങ്കിൽ അകസ്മാത കാര്യങ്ങൾ ഉണ്ടാകാമെന്നതിൽ ദയവായി ശ്രദ്ധിക്കുക. സ്രോതസ്സ് ഭാഷയിൽ ഉള്ള യഥാർത്ഥ ഡോക്യമെന്റ് പ്രാമാണികമായ സ്രോതസ്സ് ആയി പരിഗണിക്കേണ്ടതാണ്. നിർണായക വിവരങ്ങൾക്കായി, പ്രൊഫഷണൽ മനുഷ്യ വിവർത്തനം ഉചിതമാണ്. ഈ വിവർത്തനം ഉപയോഗിക്കുന്നതിനാൽ ഉണ്ടാകുന്ന misunderstanഡിംഗുകൾക്കോ തെറ്റായ വ്യാഖ്യാനങ്ങൾക്കോ ഞങ്ങൾ ഉത്തരവാദിത്വം വഹിക്കുന്നില്ല.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->